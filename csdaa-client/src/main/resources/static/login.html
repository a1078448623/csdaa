<!DOCTYPE html>
<html lang="ch">
<head>
    <meta charset="UTF-8">
    <title>用户登录</title>
    <link rel="stylesheet" href="layui-v2.6.5/layui/css/layui.css">
    <script src="js/jquery-3.6.0.min.js"></script>
    <script src="js/iconfont.js"></script>
    <script src="layui-v2.6.5/layui/layui.js"></script>
</head>
<style>
    .login-main{position: absolute;bottom: 35vh;width: 330px}
    #username,#password,#r_username,#r_password,#r_v_password,#r_flag{width: 85%;margin-left: 30px;border: none;}
    .item{border-bottom: silver solid 1px;width: 80%;margin-left: 25px;}
    .login-top{line-height:90px;height: 90px;text-align: center;font-size: 28px;background-color: #008fd7;color: white;border-top-left-radius: 15px;border-top-right-radius: 15px}
    .login_input{height: 300px;background-color: white;border-bottom-left-radius: 10px;border-bottom-right-radius: 10px}
    .hide{display: none;}
    .main-body{background: url("img/back6.jpeg") no-repeat;height: 100vh;width: 100vw;background-size: 100vw 100vh;}
</style>
<body style="background-color: black">
<div class="main-body layui-row">
    <div class="login-main layui-col-lg-offset5 layui-col-lg2 layui-col-md-offset4 layui-col-md4" id="login_block">
        <div class="login-top">
            <span>欢迎登录</span>
        </div>
        <div class="login_input">
            <form class="layui-form login-bottom" style="height: 80%">
                <div class="center" style="padding-top: 4vh">
                    <div class="item" style="position:relative;">
                        <span style="position: absolute;bottom: 10px;"><i class="layui-icon layui-icon-username" style="font-size: 22px;"></i></span>
                        <input type="text" name="username" id="username" lay-verify="required"  placeholder="请输入登录账号" class="layui-input"/>
                    </div>

                    <div class="item" style="position:relative;margin-top: 40px">
                        <span style="position: absolute;bottom: 10px"> <i class="layui-icon layui-icon-password" style="font-size: 22px;"></i></span>
                        <input type="password" name="password" id="password" lay-verify="required"  placeholder="请输入密码" class="layui-input">
                        <span class="bind-password icon icon-4"></span>
                    </div>
                </div>
                <div style="margin-top: 10px;margin-right:20px;text-align: right;">
                    <a id="goreg" style="color: violet;cursor: pointer">立即注册></a>
                </div>
            </form>
            <div class="layui-form-item" style="text-align:center; width:100%;height:100%;">
                <button class="layui-btn layui-btn-normal" id="login_button" >立即登录</button>
            </div>
        </div>
    </div>
    <div class="hide layui-col-lg-offset5 layui-col-lg2 layui-col-md-offset4 layui-col-md4" id="register_block" style="position: absolute;bottom: 35vh;width: 330px">
        <div class="register_top" style="height: 390px;background-color:white;border-top-left-radius: 15px;border-top-right-radius: 15px;">
            <div style="background-color: #008fd7;border-top-left-radius: 15px;border-top-right-radius: 15px;">&ensp;</div>
            <div style="font-size: 18px;background-color: #008fd7;padding-bottom: 20px;">
                <a id="gologin" style="color: white;cursor: pointer;margin-left: 10px;margin-bottom: 10px">< 返回</a>
            </div>
            <form class="layui-form login-bottom" style="">
                <div class="center" style="padding-top: 25px">
                    <div class="item" style="position:relative;">
                        <span style="position: absolute;bottom: 10px;"><i class="layui-icon layui-icon-username" style="font-size: 22px;"></i></span>
                        <input type="text" name="username" id="r_username" lay-verify="required"  placeholder="请输入账号" class="layui-input"/>
                    </div>
                    <div class="item" style="position:relative;margin-top: 25px">
                        <span style="position: absolute;bottom: 10px"> <i class="layui-icon layui-icon-password" style="font-size: 22px;"></i></span>
                        <input type="password" name="password" id="r_password" lay-verify="required"  placeholder="请输入密码" class="layui-input">
                        <span class="bind-password icon icon-4"></span>
                    </div>
                    <div class="item" style="position:relative;margin-top: 25px">
                        <span style="position: absolute;bottom: 10px"> <i class="layui-icon layui-icon-auz" style="font-size: 22px;"></i></span>
                        <input type="password" name="r_password" id="r_v_password" lay-verify="required"  placeholder="确认密码" class="layui-input">
                        <span class="bind-password icon icon-4"></span>
                    </div>
                    <div class="item" style="position:relative;margin-top: 25px">
                        <span style="position: absolute;bottom: 10px"> <i class="layui-icon layui-icon-note" style="font-size: 22px;"></i></span>
                        <input type="text" name="flag" id="r_flag" lay-verify="required"  placeholder="自定义标识" class="layui-input">
                        <span class="bind-password icon icon-4"></span>
                    </div>
                </div>
                <!--                <div style="margin-top: 10px;margin-right:20px;text-align: right;">-->
                <!--                    <a id="goreg" style="color: violet;cursor: pointer">立即注册></a>-->
                <!--                </div>-->
            </form>
            <div class="layui-form-item" style="text-align:center; width:100%;height:100%;margin-top: 10px">
                <button class="layui-btn layui-btn-normal" id="register_button" >注册</button>
            </div>
        </div>
    </div>

</div>
</body>
<script>
    $("#goreg").click(function (){
        $("#login_block").addClass("hide")
        $("#register_block").removeClass("hide")
    })
    $("#gologin").click(function (){
        $("#register_block").addClass("hide");
        $("#login_block").removeClass("hide")
    })
    $("#register_button").click(function (){
        layui.use(['table','layer'], function(){
            let layer=layui.layer;
            let username=$("#r_username").val();
            let password=$("#r_password").val();
            let secpass=$("#r_v_password").val();
            let flag=$("#r_flag").val();
            if(username===""||password===""||secpass===""||flag===""){
                layer.msg('不能为空', {icon: 5})
            }
            else if(password!==secpass){
                layer.msg('两次密码不同', {icon: 5})
            }
            else {
                $.ajax({
                    url:'/web/register',
                    method: 'post',
                    data:{
                        username:username,
                        password:password,
                        flag:flag
                    },
                    success:function (res){
                        if (res === "") {
                            layer.msg('账号已存在', {icon: 5})
                        } else {
                            layer.msg('注册并登陆成功', {icon: 6})
                            window.location.href = "index.html";
                        }
                    }
                })
            }
        })
    })
$("#login_button").click(function (){
    layui.use(['table','layer'], function(){
        let layer=layui.layer;
        let username=$("#username").val();
        let password=$("#password").val();
        if(username===""||password===""){
            layer.msg('账号或密码不能为空', {icon: 5})
        }
        else {
            $.ajax({
                url: "/web/login",
                method: 'post',
                data: {
                    username: username,
                    password: password
                },
                success: function (res) {
                    if (res === "") {
                        layer.msg('账号或密码错误', {icon: 5})
                    } else {
                        layer.msg('登陆成功', {icon: 6})
                        window.location.href = "index.html";
                    }
                }
            })
        }
    })

})
</script>
</html>